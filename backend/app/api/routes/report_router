from fastapi import Depends
from app.auth.auth_bearer import get_current_user
from app.models.user_model import User

@router.get("/assigned/count")
async def count_assigned_reports(
    db: AsyncIOMotorDatabase = Depends(get_database),
    current_user: User = Depends(get_current_user)
):
    reports = await db.incident_reports.count_documents({
        "assigned_to": str(current_user.id),  # match secretaria ID
        "is_converted_to_case": False
    })
    return {"assigned_reports": reports}
